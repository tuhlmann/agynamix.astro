---
import { Tags } from "../blocks/Tags"
import {Markdown} from "astro/components"
import { formatDate } from "../utils/prepare-story-data"

export interface Props {
	post: any;
	author: string;
}
const { post, author } = Astro.props;

function excerpt(str: string): string {
	return str.substring(0, 250) + "..."
}

// console.log(post);

let bannerImg = "" 
// try {
//   bannerImg = (await import(`../pages${post.url}/${post.banner}`)).default
// } catch (err) {
// 	console.log(`Cannot import banner img ../pages${post.url}/${post.banner}`, err);
// }
---

<div class="mt-5 bg-white p-10 flex flex-col">
	{post.banner && (
		<div class="p-5 sm:pb-3">
			<a
				aria-label={`View ${post.title} article`}
				href={post.url}
			>
				<img src={bannerImg} />
			</a>
		</div>
	)}
	<h2 class="mt-7 mb-3">
		<a
			aria-label={`View ${post.title} article`}
			href={post.url}
		>
			{post.title}
		</a>
	</h2>
	<div class="flex justify-between flex-col-reverse sm:flex-row">
		<small class="opacity-60 font-semibold">
			{formatDate(post.date)}
		</small>
		<Tags tags={post.tags} withLink />
	</div>
	<p class="mt-3">
	  <Markdown>
		  {excerpt(post.content.source)}
		</Markdown>
	</p>
	<a
		href={post.url}
		aria-label={`view "${post.title}" article`}
	>
		Read â†’
	</a>
</div>


<!--
<article class="post">
	<div class="data">
		<h2>{post.title}</h2>
		<a class="author" href={`/authors/${post.author}`}>{author?.name}</a>
		<time class="date" datetime={post.date}>{formatDate(post.date)}</time>
		<p class="description">
			{post.description}
			<a class="link" href={post.url} aria-label={`Read ${post.title}`}>Read</a>
		</p>
	</div>
</article>

<style>
	.post {
		padding-top: 6rem;
		padding-bottom: 6rem;
		border-bottom: 1px solid rgba(black, 0.25);
		text-align: center;
	}

	.author {
		text-transform: uppercase;
	}

	.date {
		font-style: italic;
	}

	.description {
		font-size: 1.25em;
	}

	.link {
		text-transform: uppercase;
		font-size: 0.8em;
		margin-left: 1em;
	}

	h2 {
		font-weight: 700;
		font-size: 2.75em;
		line-height: 1;
		letter-spacing: -0.04em;
		margin-top: 0;
		margin-bottom: 0;
	}

	time {
		display: block;
		margin-top: 0.25rem;
		margin-bottom: 0.5em;
	}
</style>

-->